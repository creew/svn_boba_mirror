/*
    SieNatJabber Project
    Функции работы с контакт-листом

    Данный API обязан присутствовать во ВСЕХ вариантах контакт-листа
*/

#ifndef _CLIST_UTIL_H_
  #define _CLIST_UTIL_H_

#include "main.h"

#define CHAR_ON_LINE 20

#define CLIST_FONT FONT_SMALL     // Шрифт контакт-листа

#define CLIST_Y1 5 + SCR_START               // ad: меньше сделал (26->5)
/* ACHTUNG
#ifdef STD_PALETTE
#define CURSOR 6                 // ad: цвет курсора

#define CURSOR_BORDER 20         // ad: цвет ободка курсора

#define CLIST_F_COLOR_0 1         // Цвет шрифта
#define CLIST_F_COLOR_1 15        // Цвет шрифта (есть сообщения)
#define CONTACT_BG_0 0
#define CONTACT_BG_1 22
#else
const RGBA CURSOR = {80, 80, 255, 100};
const RGBA CURSOR_BORDER = {200, 200, 200, 100};
const RGBA CLIST_F_COLOR_0 = {0, 0, 0, 100};
const RGBA CLIST_F_COLOR_1 = {0, 0, 170, 100};
const RGBA CONTACT_BG_0 = {255, 255, 255, 100};
const RGBA CONTACT_BG_1 = {220, 220, 220, 100};
#endif*/

// Отрисовать список контактов
  void CList_RedrawCList();

// Получить дескриптор контакта по FullJID (JID вместе с ресурсом)
  CLIST* CList_FindContactByJID(char* jid);

// Узнать, есть ли уже такой ресурс у контакта, по FullJID
  TRESOURCE* CList_IsResourceInList(char* jid);

// Добавить к листу контакт. Возвращает структуру созданного контакта.
  CLIST* CList_AddContact(char* jid,
                          char* name,
                          JABBER_SUBSCRIPTION subscription,
                          char wants_subscription,
                          char group
                          );

// Изменить параметры контакта (получена подписка и пр)

  void CList_ChangeContactParams(CLIST* Cont_Ex,
                          char* name,
                          JABBER_SUBSCRIPTION subscription,
                          char wants_subscription,
                          char group);

// Пишет роли контакта в конфе в структуру
  void CList_MUC_SetRole(char* jid, CONF_PRIV priv);

// Добавить сообщение в список сообщений контакта
  void CList_AddMessage(char* jid, MESS_TYPE mtype, char* mtext);

// Добавить системное сообщение
  void CList_AddSystemMessage(char* jid, char status, char* status_msg);
// Оно же, но принимает ANSI-строку. Полезно в отдельных случаях :)
  void CList_AddSystemMessageA(char* jid, char status, char* ansi_status_msg);

  TRESOURCE* CList_AddResourceWithPresence(char* jid, char status, char* status_msg);

// Получить контакт, на котором стоит курсор
  TRESOURCE* CList_GetActiveContact();

// Делаем оффлайнами все ресурсы заданного контакта. Useful для конференций.
  void CList_MakeAllResourcesOFFLINE(CLIST* ClEx);

// Уничтожить список контактов
  void CList_Destroy();

// Изменить режим отображения контактов оффлайн
  void CList_ToggleOfflineDisplay();

// Получить число онлайн-юзверей
  unsigned int CList_GetNumberOfOnlineUsers();

// Получить число юзверей
  unsigned int CList_GetNumberOfUsers();

// Получить число непрочитанных
  unsigned int CList_GetUnreadMessages();

// переход на следующий контакт с непрочитанным сообщением
  void nextUnread();

// ставим курсор на нужный ресурс(для автофокуса тоже пригодится)
  void MoveCursorTo(TRESOURCE* NewResEx);

void CList_Display_Popup_Info(TRESOURCE* ResEx);

// Управление курсором
  void CList_MoveCursorUp();
  void CList_MoveCursorDown();

  void CList_MoveCursorHome();
  void CList_MoveCursorEnd();

// Убить список сообщений
void KillMsgList(LOG_MESSAGE* messtop);

#endif
