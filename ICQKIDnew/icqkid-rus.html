<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.0  (Linux)">
	<META NAME="AUTHOR" CONTENT="Neo The Matrix">
	<META NAME="CREATED" CONTENT="20051107;17262400">
	<META NAME="CHANGED" CONTENT="20070210;23390700">
</HEAD>
<BODY LANG="ru-RU" DIR="LTR">
<DIV ID="Оглавление1" DIR="LTR">
	<DIV ID="Оглавление1_Head" DIR="LTR">
		<P><FONT FACE="Arial"><FONT SIZE=4><B>Оглавление</B></FONT></FONT></P>
	</DIV>
	<DL>
		<DT> 1.<A HREF="#1.Архитектура библиотеки|outline">Архитектура
		библиотеки</A><DT>
		 2.<A HREF="#2.Инициализация объекта|outline">Инициализация
		объекта</A><DT>
		 2.1.<A HREF="#2.1.setUIN|outline">setUIN</A><DT>
		 2.2.<A HREF="#2.2.setPassword|outline">setPassword</A><DT>
		 2.3.<A HREF="#2.3.setLoginHost|outline">setLoginHost</A><DT>
		 2.4.<A HREF="#2.4.setProxy|outline">setProxy</A><DT>
		 3.<A HREF="#3.Подключение|outline">Подключение</A><DT>
		 3.1.<A HREF="#3.1.doConnect|outline">doConnect</A><DT>
		 3.2.<A HREF="#3.2.doDisconnect|outline">doDisconnect</A><DT>
		 3.3.<A HREF="#3.3.setStatus|outline">setStatus</A><DT>
		 3.4.<A HREF="#3.4.getMyOnlineStatus|outline">getMyOnlineStatus</A><DT>
		 3.5.<A HREF="#3.5.Управление авто-сообщениями для статусов|outline">Управление
		авто-сообщениями для статусов</A><DT>
		 3.6.<A HREF="#3.6.Коды статусов|outline">Коды
		статусов</A><DT>
		 3.7.<A HREF="#3.7.setXStatus|outline">setXStatus</A><DT>
		 4.<A HREF="#4.Управление учетной записью|outline">Управление
		учетной записью</A><DT>
		 4.1.<A HREF="#4.1.registerNewUIN|outline">registerNewUIN</A><DT>
		 4.2.<A HREF="#4.2.changePassword|outline">changePassword</A><DT>
		 5.<A HREF="#5.Контакт-лист и контакты|outline">Контакт-лист
		и контакты</A><DT>
		 5.1.<A HREF="#5.1.getUserInfo|outline">getUserInfo</A><DT>
		 5.2.<A HREF="#5.2.getFullUserInfo|outline">getFullUserInfo</A><DT>
		 5.3.<A HREF="#5.3.publicMyInfo|outline">publicMyInfo</A><DT>
		 5.4.<A HREF="#5.4.searchByMail|outline">searchByMail</A><DT>
		 5.5.<A HREF="#5.5.searchByUIN|outline">searchByUIN</A><DT>
		 5.6.<A HREF="#5.6.searchByWhitePages|outline">searchByWhitePages</A><DT>
		 5.7.<A HREF="#5.7.addContact|outline">addContact</A><DT>
		 5.8.<A HREF="#5.8.removeContact|outline">removeContact</A><DT>
		 5.9.<A HREF="#5.9.renameContact|outline">renameContact</A><DT>
		 5.10.<A HREF="#5.10.addContacts/removeContacts/renameContacts|outline">addContacts/removeContacts/renameContacts</A><DT>
		 5.11.<A HREF="#5.11.addBLMContact|outline">addBLMContact</A><DT>
		 5.12.<A HREF="#5.12.removeBLMContact|outline">removeBLMContact</A><DT>
		 5.13.<A HREF="#5.13.addBLMContacts|outline">addBLMContacts</A><DT>
		 5.14.<A HREF="#5.14.removeBLMContacts|outline">removeBLMContacts</A><DT>
		 5.15.<A HREF="#5.15.addGroup|outline">addGroup</A><DT>
		 5.16.<A HREF="#5.16.removeGroup|outline">removeGroup</A><DT>
		 5.17.<A HREF="#5.17.renameGroup|outline">renameGroup</A><DT>
		 5.18.<A HREF="#5.18.updateContactList|outline">updateContactList</A><DT>
		 5.19.<A HREF="#5.19.findCLUIN|outline">findCLUIN</A><DT>
		 5.20.<A HREF="#5.20.findCLGroup|outline">findCLGroup</A><DT>
		 5.21.<A HREF="#5.21.Векторы ContactListUins и ContactListGroups|outline">Векторы
		ContactListUins и ContactListGroups</A><DT>
		 5.22.<A HREF="#5.22.Структура ICQKidShortUserInfo|outline">Структура
		ICQKidShortUserInfo</A><DT>
		 5.23.<A HREF="#5.23.Структура SSIUINEntry|outline">Структура
		SSIUINEntry</A><DT>
		 5.24.<A HREF="#5.24.Структура SSIGroupEntry|outline">Структура
		SSIGroupEntry</A><DT>
		 5.25.<A HREF="#5.25.Расширенные коды ошибок|outline">Расширенные
		коды ошибок</A><DT>
		 6.<A HREF="#6.Авторизация|outline">Авторизация</A><DT>
		 6.1.<A HREF="#6.1.authRequest|outline">authRequest</A><DT>
		 6.2.<A HREF="#6.2.authReply|outline">authReply</A><DT>
		 6.3.<A HREF="#6.3.Коды авторизации|outline">Коды
		авторизации</A><DT>
		 7.<A HREF="#7.Управление настройками конфиденциальности|outline">Управление
		настройками конфиденциальности</A><DT>
		 7.1.<A HREF="#7.1.addVisible|outline">addVisible</A><DT>
		 7.2.<A HREF="#7.2.removeVisible|outline">removeVisible</A><DT>
		 7.3.<A HREF="#7.3.addInvisible|outline">addInvisible</A><DT>
		 7.4.<A HREF="#7.4.removeInvisible|outline">removeInvisible</A><DT>
		 7.5.<A HREF="#7.5.addIgnore|outline">addIgnore</A><DT>
		 7.6.<A HREF="#7.6.removeIgnore|outline">removeIgnore</A><DT>
		 7.7.<A HREF="#7.7.setMyPrivacyStatus|outline">setMyPrivacyStatus</A><DT>
		 7.8.<A HREF="#7.8.getMyPrivacyStatus|outline">getMyPrivacyStatus</A><DT>
		 8.<A HREF="#8.Посылка данных|outline">Посылка
		данных</A><DT>
		 8.1.<A HREF="#8.1.sendMessage|outline">sendMessage</A><DT>
		 8.2.<A HREF="#8.2.sendMTN|outline">sendMTN</A><DT>
		 9.<A HREF="#9.Работа с иконками/аватарками|outline">Работа
		с иконками/аватарками</A><DT>
		 9.1.<A HREF="#9.1.getBuddyIcon|outline">getBuddyIcon</A><DT>
		 9.2.<A HREF="#9.2.downloadMyIcon|outline">downloadMyIcon</A><DT>
		 9.3.<A HREF="#9.3.uploadMyIcon|outline">uploadMyIcon</A><DT>
		 9.4.<A HREF="#9.4.deleteMyIcon|outline">deleteMyIcon</A><DT>
		 10.<A HREF="#10.Основной цикл|outline">Основной
		цикл</A><DT>
		 10.1.<A HREF="#10.1.mainLoop|outline">mainLoop</A><DT>
		 11.<A HREF="#11.Коллбэки|outline">Коллбэки</A><DT>
		 11.1.<A HREF="#11.1.onIdle|outline">onIdle</A><DT>
		 11.2.<A HREF="#11.2.onIncomingMTN|outline">onIncomingMTN</A><DT>
		 11.3.<A HREF="#11.3.onIncomingMsg|outline">onIncomingMsg</A><DT>
		 11.4.<A HREF="#11.4.onAuthRequest|outline">onAuthRequest</A><DT>
		 11.5.<A HREF="#11.5.onAuthReply|outline">onAuthReply</A><DT>
		 11.6.<A HREF="#11.6.onUserNotify|outline">onUserNotify</A><DT>
		 11.7.<A HREF="#11.7.onContactListChanged|outline">onContactListChanged</A><DT>
		 11.8.<A HREF="#11.8.onWasAdded|outline">onWasAdded</A><DT>
		 11.9.<A HREF="#11.9.onIconChanged|outline">onIconChanged</A><DT>
		 11.10.<A HREF="#11.10.onXstatusChanged|outline">onXstatusChanged</A><DT>
		 11.11.<A HREF="#11.11.onRegisterControlPicture|outline">onRegisterControlPicture</A><DT>
		 11.12.<A HREF="#11.12.onIncomingAutoStatusMsg|outline">onIncomingAutoStatusMsg</A><DT>
		 11.13.<A HREF="#11.13.onSingOff|outline">onSingOff</A><DT>
		 12.<A HREF="#12.Методы продвинутого использования|outline">Методы
		продвинутого использования</A><DT>
		 12.1.<A HREF="#12.1.getConnectPercentage|outline">getConnectPercentage</A><DT>
		 12.2.<A HREF="#12.2.setNetworkTimeout|outline">setNetworkTimeout</A><DT>
		 12.3.<A HREF="#12.3.getNetworkTimeout|outline">getNetworkTimeout</A><DT>
		 12.4.<A HREF="#12.4.breakNetworkOperation|outline">breakNetworkOperation</A><DT>
		 12.5.<A HREF="#12.5.getOfflineMessages|outline">getOfflineMessages</A><DT>
		 12.6.<A HREF="#12.6.pollIncomingEvents|outline">pollIncomingEvents</A></DL>
</DIV>
<DL>
	<DT><BR>
</DL>
<H1><A NAME="1.Архитектура библиотеки|outline"></A>
 1.Архитектура библиотеки</FONT></FONT></H1>
<OL>
	<P><FONT FACE="Arial">Основным элементом библиотеки
	является класс <B>ICQKid2</B>, содержащий
	базовые методы управления сессией и
	набор коллбэков, оформленных в виде
	виртуальных методов, предназначенных
	для замещения при наследовании. Типичным
	использованием класса <B>ICQKid2</B> является
	наследование от него другого класса с
	замещением требуемых виртуальных
	методов, создание объекта этого класса,
	его инициализация, установление
	соединения и запуск основного цикла.
	В ходе выполнения основного цикла, по
	мере надобности вызываются нужные
	коллбэки – перегруженные виртуальные
	методы. После завершения главного цикла
	следует разрыв соединения.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>#include &lt;icqkid2.h&gt;</B></FONT></FONT></P>
	<P><FONT COLOR="#b84700"><FONT FACE="Courier New"><FONT SIZE=2><B>//
	Inherited class declaration</B></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>class MyIcqInterface :
	public ICQKid2{</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>public:</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>MyIcqInterface(void);</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual
	~MyIcqInterface();</B></FONT></FONT></P>
	<P><FONT COLOR="#b84700"><FONT FACE="Courier New"><FONT SIZE=2><B>//
	CallBacks</B></FONT></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onIdle(void);</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onIncomingMsg(string from, string text, bool offl_msg=false);</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onAuthRequest(string from, string text);</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onAuthReply(string from, string text, uint8_t aflag);</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onUserNotify(string uin, uint32_t stat1, uint32_t stat2, bool
	invis_flag);</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onContactListChanged(void) ;</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onWasAdded(string from);</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onIconChanged(string uin);</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onXstatusChanged(string uin, size_t x_status, string x_title, string
	x_descr);</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onRegisterControlPicture(vector&lt;uint8_t&gt; &amp; pic_data,
	string mime_type, string &amp; pic_str);</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onIncomingAutoStatusMsg(ICQKid2Message msg, uint8_t type);</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onSingOff(uint16_t err_code, string err_url);</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>};</B></FONT></FONT></P>
	<P><FONT COLOR="#b84700"><FONT FACE="Courier New"><FONT SIZE=2><B>//
	Inherited class methods definition</B></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>MyIcqInterface::MyIcqInterface(void)
	: ICQKid2() {...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>MyIcqInterface::~MyIcqInterface()
	{...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onIdle(void) {...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onIncomingMsg(string from, string text, bool
	offl_msg){...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onAuthRequest(string from, string text){...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onAuthReply(string from, string text, uint8_t
	aflag){...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onUserNotify(string uin, uint32_t stat1, uint32_t
	stat2, bool invis_flag) {...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onContactListChanged(void) {...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onWasAdded(string from) {...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onIconChanged(string uin) {...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onXstatusChanged(string uin, size_t x_status, string
	x_title, string x_descr) {...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onRegisterControlPicture(vector&lt;uint8_t&gt; &amp;
	pic_data, string mime_type, string &amp; pic_str) {...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onIncomingAutoStatusMsg(ICQKid2Message msg, uint8_t
	type) {...}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onSingOff(uint16_t err_code, string err_url) {...}</B></FONT></FONT></P>
	<P><FONT COLOR="#b84700"><FONT FACE="Courier New"><FONT SIZE=2><B>//
	Main program</B></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>int main(int argc, char
	** argv)</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>MyIcqInterface miif;</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>miif.setUIN(&quot;123456&quot;);</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>miif.setPassword(&quot;MyPassword&quot;);</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.doConnect(STATUS_BIRTHDAY|STATUS_FREE4CHAT))</B></FONT></FONT></P>
	<P>   <FONT FACE="Courier New"><FONT SIZE=2><B>return 1;</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>bool
	my_break_flag=false;</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.mainLoop(my_break_flag))</B></FONT></FONT></P>
	<P>   <FONT FACE="Courier New"><FONT SIZE=2><B>return 1;</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>miif.doDisconnect();</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>return 0;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>}</B></FONT></FONT></P>
</OL>
<H1><A NAME="2.Инициализация объекта|outline"></A>
 2.Инициализация объекта</FONT></FONT></H1>
<OL START=2>
	<P><FONT FACE="Arial">Здесь описываются методы
	инициализации объекта перед соединением.</FONT></P>
</OL>
<H2><A NAME="2.1.setUIN|outline"></A> 2.1.setUIN</I></FONT></FONT></H2>
<OL START=2>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void setUIN(string auin)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод устанавливает UIN
	пользователя согласно аргументу <B>auin</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.setUIN(&quot;123456&quot;);</B></FONT></FONT></P>
</OL>
<H2><A NAME="2.2.setPassword|outline"></A> 2.2.setPassword</I></FONT></FONT></H2>
<OL START=2>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void setPassword(string
	apwd)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод устанавливает
	ICQ-пароль согласно аргументу <B>apwd</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.setPassword(&quot;MyPass&quot;);</B></FONT></FONT></P>
</OL>
<H2><A NAME="2.3.setLoginHost|outline"></A> 2.3.setLoginHost</I></FONT></FONT></H2>
<OL START=2>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void setLoginHost(string
	ahost=&quot;login.oscar.aol.com&quot;, int aport=5190)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод устанавливает адрес
	и порт ICQ-сервера согласно аргументам
	<B>ahost</B> и <B>aport</B> с соответствующими
	значениями по умолчанию.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.setLoginHost
	(&quot;icq2.mirabilis.com&quot;, 443);</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.setLoginHost
	(&quot;login.aol.com&quot;);</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.SetLoginHost ();</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Значения по умолчанию
	устанавливаются при создании объекта
	и не требуют явного вызова метода.</FONT></P>
</OL>
<H2><A NAME="2.4.setProxy|outline"></A> 2.4.setProxy</I></FONT></FONT></H2>
<OL START=2>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void setProxy(string
	ahost=&quot;&quot;, int aport=0, string auid=&quot;&quot;, string
	apwd=&quot;&quot;, ProxyType apr_type=NONE)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод устанавливает адрес,
	порт, логин, пароль и тип прокси-сервера.
	Поддерживаются следующие типы
	прокси-серверов:</FONT></P>
	<P><FONT FACE="Arial"><B>ICQKid2::NONE</B> – без прокси-сервера</FONT></P>
	<P><FONT FACE="Arial"><B>ICQKid2::HTTP</B> – HTTP-прокси с
	basic-аутентификацией (если <B>auid</B> или
	<B>apwd</B> – пустая строка, то без
	аутентификации)</FONT></P>
	<P><FONT FACE="Arial"><B>ICQKid2::SOCKS4</B> – SOCKS4-прокси,
	<B>auid</B> используется в качестве userid</FONT></P>
	<P><FONT FACE="Arial"><B>ICQKid2::SOCKS5</B> – SOCKS5-прокси
	с автоопределением аутентификации
	(без нее, либо по RFC1929)</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.setProxy(&quot;proxy.com&quot;,
	8080, &quot;MyProxyLogin&quot;, &quot;MyProxyPass&quot;,
	ICQKid2::HTTP);</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.setProxy(&quot;proxy.com&quot;,
	8080, &quot;&quot;, &quot;&quot;, ICQKid2::HTTP);</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.setProxy(&quot;proxy.org&quot;,
	1080, &quot;UserID&quot;, &quot;&quot;, ICQKid2::SOCKS4);</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.setProxy();</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Значения по умолчанию
	устанавливаются при создании объекта
	и не требуют явного вызова метода.</FONT></P>
</OL>
<H1><A NAME="3.Подключение|outline"></A> 3.Подключение</FONT></FONT></H1>
<OL START=3>
	<P><FONT FACE="Arial">Здесь описываются методы
	подключения и авторизации на ICQ-сервере
	и установления статуса клиента.</FONT></P>
</OL>
<H2><A NAME="3.1.doConnect|outline"></A> 3.1.doConnect</I></FONT></FONT></H2>
<OL START=3>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool doConnect(uint32_t
	astat=STATUS_ONLINE)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод пытается установить
	соединение с ICQ-сервером по адресу и
	порту по умолчанию, либо явно определенными
	методом <B>setLoginHost</B>. Соединение по
	умолчанию происходит напрямую, либо
	через HTTP-прокси, согласно параметрам,
	установленным при явном вызове <B>setProxy</B>.
	После этого производится попытка
	аутентификации пользователя согласно
	UIN'у и ICQ-паролю, установленными при
	вызовах методов <B>setUIN </B>и <B>setPassword</B>.
	После успешной аутентификации
	устанавливается статус клиента, согласно
	аргументу <B>astat</B>, либо его значению по
	умолчанию. Возможные коды статусов
	описаны ниже.</FONT></P>
	<P><FONT FACE="Arial">При успешном соединении
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Arial">Если метод вернул <B>false</B>,<B>
	</B>в переменную <B>connect_error_code </B>заносится
	код ошибки, а в переменную <B>connect_error_url
	</B>возможный URL ее описания.</FONT></P>
	<P><FONT FACE="Arial">В файле <B>icqkid2_constants.h
	</B>определены следующие коды ошибок
	соединения:</FONT></P>
	<P><FONT FACE="Arial"><B>CONN_ERR_BAD_LOGIN</B> – UIN,
	установленный при вызове <B>setUIN()</B>, не
	существует.</FONT></P>
	<P><FONT FACE="Arial"><B>CONN_ERR_BAD_PASSWORD</B> – UIN
	существует, но пароль, установленный
	при вызове <B>setPassword()</B>, неверен.</FONT></P>
	<P><FONT FACE="Arial"><B>CONN_ERR_RATE_LIMIT</B> – Слишком
	много попыток соединения за короткий
	период времени, нужно подождать некоторое
	время.</FONT></P>
	<P><FONT FACE="Arial">В процессе соединения около
	10 раз в секунду вызывается коллбэк-метод
	<B>onIdle</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if (!miif.doConnect())
	{...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.doConnect(STATUS_BIRTHDAY|STATUS_FREE4CHAT))</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>switch(miif.connect_error_code)</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<P>   <FONT FACE="Courier New"><FONT SIZE=2><B>case
	CONN_ERR_BAD_LOGIN :</B></FONT></FONT></P>
	<P>   <FONT FACE="Courier New"><FONT SIZE=2><B>...</B></FONT></FONT></P>
</OL>
<H2><A NAME="3.2.doDisconnect|outline"></A> 3.2.doDisconnect</I></FONT></FONT></H2>
<OL START=3>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void doDisconnect(void)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод отключает от
	ICQ-сервера.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.doDisconnect();</B></FONT></FONT></P>
</OL>
<H2><A NAME="3.3.setStatus|outline"></A> 3.3.setStatus</I></FONT></FONT></H2>
<OL START=3>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool setStatus(uint32_t
	astat)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод пытается установить
	статус клиента согласно аргументу
	<B>astat</B>. Возможные коды статусов описаны
	ниже.</FONT></P>
	<P><FONT FACE="Arial">При успешной смене статуса
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.setStatus(STATUS_DND|STATUS_INVISIBLE)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="3.4.getMyOnlineStatus|outline"></A> 3.4.getMyOnlineStatus</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>uint32_t
	getMyOnlineStatus(void) const</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод возвращает текущий
	статус клиента.</FONT></P>
</DL>
<H2><A NAME="3.5.Управление авто-сообщениями для статусов|outline"></A>
 3.5.Управление авто-сообщениями для
статусов</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>string
	AutoAwayMessageText;</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>string
	AutoBusyMessageText;</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>string
	AutoNotAvailableMessageText;</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>string
	AutoDoNotDisturbMessageText;</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>string
	AutoFreeForChatMessageText;</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Данные строки находятся
	в public-зоне класса <B>ICQKid2</B> и предназначены
	для задания авто-сообщений статусов
	Away/Busy/NA/DND/FFC.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.AutoAwayMessageText=&quot;I'm
	cooking my breakfast, you can leave message for me&quot;;</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.setStatus(STATUS_AWAY);</B></FONT></FONT></P>
</DL>
<H2><A NAME="3.6.Коды статусов|outline"></A> 3.6.Коды
статусов</I></FONT></FONT></H2>
<OL START=3>
	<P><FONT FACE="Arial">Здесь приводятся статусы,
	используемые методами <B>doConnect</B>,
	<B>setStatus</B> и коллбэком <B>onUserNotify</B>.</FONT></P>
	<P><FONT FACE="Arial">Основные статусы (в коллбэк
	приходят, как <B>stat1</B>):</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_ONLINE</B> - в сети и доступен</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_AWAY</B> – отошел</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_DND</B> – не беспокоить</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_NA</B> - недоступен</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_OCCUPIED</B> - занят</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_FREE4CHAT</B> – готов
	чатиться</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_EVIL</B> - злой</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_DEPRESSION</B> - депрессия</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_HOME</B> - дома</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_WORK</B> – на работе</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_LUNCH</B> - кушаю</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_OFFLINE</B> – отсоединен
	(явно не выставляется, приходит только
	в коллбэк)</FONT></P>
	<P><FONT FACE="Arial">Дополнительные статусы,
	при выставлении накладываются на
	основные с помощью логического OR,
	приходят в коллбэк, как <B>stat2</B>.
	<B>STATUS_INVISIBLE</B> приходит в коллбэк, как
	флаг <B>bool invis_flag</B>:</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_WEBAWARE</B> – можно
	публиковать статус в WWW</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_SHOWIP</B> – показывать
	IP-адрес</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_BIRTHDAY</B> – сегодня день
	рождения</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_WEBFRONT</B> – выставить
	webfront флаг</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_DCDISABLED</B> – прямые
	соединения между клиентами запрещены</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_DCAUTH</B> – прямые
	соединения только после авторизации</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_DCCONT</B> – прямые
	соединения только с клиентами из
	контакт-листа</FONT></P>
	<P><FONT FACE="Arial"><B>STATUS_INVISIBLE</B> – невидимый</FONT></P>
	<P><FONT FACE="Arial">Текущая реализация библиотеки
	не поддерживает прямые соединения
	между клиентами, поэтому при выставлении
	статуса к нему всегда автоматически
	добавляется <B>STATUS_DCDISABLED</B>.</FONT></P>
</OL>
<H2><A NAME="3.7.setXStatus|outline"></A> 3.7.setXStatus</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	setXStatus(size_t x_stat, string title, string descr)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод устанавливает
	дополнительный xStatus (расширение XtraZ),
	его заголовок и описание. Возможные
	типы <B>x_stat</B> перечислены в
	<B>icqkid2_constants.h</B>. Аргументы <B>title</B> и <B>descr</B>
	принято указывать в кодировке UTF-8.</FONT></P>
</DL>
<OL START=3>
	<P><FONT FACE="Arial">При успешной смене статуса
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
</OL>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!setXStatus(X_STATUS_EAT, &quot;Обед&quot;, &quot;Пришло
	время подкрепиться!&quot;)) {...</B></FONT></FONT></P>
</DL>
<H1><A NAME="4.Управление учетной записью|outline"></A>
 4.Управление учетной записью</FONT></FONT></H1>
<H2><A NAME="4.1.registerNewUIN|outline"></A> 4.1.registerNewUIN</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	registerNewUIN(string password, string &amp; new_uin)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод пытается
	зарегистрировать новую учетную запись
	с паролем <B>password</B>. В процессе регистрации
	возможен вызов коллбэка
	<B>onRegisterControlPicture</B> для ввода кода с
	изображения.</FONT></P>
</DL>
<OL START=4>
	<P><FONT FACE="Arial">При успешной регистрации
	возвращается <B>true</B> и новый UIN сохраняется
	в аргументе <B>new_uin</B>, иначе возвращается
	<B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>string new_uin;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!registerNewUIN(&quot;CoolPass&quot;, new_uin)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="4.2.changePassword|outline"></A> 4.2.changePassword</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	changePassword(string new_password)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод пытается изменить
	текущий пароль на <B>new_password</B>.</FONT></P>
</DL>
<OL START=4>
	<P><FONT FACE="Arial">При успешной смене пароля
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!changePassword(&quot;CoolPass&quot;)) {...</B></FONT></FONT></P>
</OL>
<H1><A NAME="5.Контакт-лист и контакты|outline"></A>
 5.Контакт-лист и контакты</FONT></FONT></H1>
<OL START=5>
	<P><FONT FACE="Arial">Здесь описываются методы,
	позволяющие управлять контактами и
	группами в контакт-листе.</FONT></P>
</OL>
<H2><A NAME="5.1.getUserInfo|outline"></A> 5.1.getUserInfo</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool getUserInfo(string
	uin, ICQKidShortUserInfo &amp; info, bool force_update=false)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод заполняет краткую
	информацию о пользователе с UIN'ом <B>uin</B>
	в структуре <B>info</B>. Формат структуры
	описан ниже. Информация кэшируется в
	целях экономии трафика, и по возможности
	берется из кэша. Если флаг <B>force_update</B>
	имеет значение <B>true</B>, информация
	запрашивается только у сервера и кэш
	не используется.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>ICQKidShortUserInfo
	uinfo;</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.getUserInfo(&quot;654987&quot;, uinfo)) {...</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.getUserInfo(&quot;654987&quot;, uinfo, true)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.2.getFullUserInfo|outline"></A> 5.2.getFullUserInfo</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	getFullUserInfo(string uin, ICQKidFullUserInfo &amp; info, bool
	force_update=false)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод заполняет полную
	информацию о пользователе с UIN'ом <B>uin</B>
	в структуре <B>info</B>. Формат структуры
	описан в файле <B>icqkid2.h</B>. Информация
	кэшируется в целях экономии трафика,
	и по возможности берется из кэша. Если
	флаг <B>force_update</B> имеет значение <B>true</B>,
	информация запрашивается только у
	сервера и кэш не используется.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>ICQKidFullUserInfo
	uinfo;</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.getFullUserInfo(&quot;123456&quot;, uinfo)) {...</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.getFullUserInfo(&quot;123456&quot;, uinfo, true)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.3.publicMyInfo|outline"></A> 5.3.publicMyInfo</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	publicMyInfo(ICQKidFullUserInfo &amp; info)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод публикует информацию,
	описанную структурой <B>info</B> как личную
	информацию пользователя.</FONT></P>
</DL>
<OL START=5>
	<P><FONT FACE="Arial">При успешной публикации
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>ICQKidFullUserInfo
	uinfo;</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.getFullUserInfo(MyUin, uinfo)) {...</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>uinfo.Firstname=&quot;John&quot;;</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>uinfo.Lastname=&quot;Smith&quot;;</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.publicMyInfo(uinfo)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.4.searchByMail|outline"></A> 5.4.searchByMail</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool searchByMail(string
	email, vector&lt;ICQKidShortUserInfo&gt; &amp; result_vec)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод ищет контакты по
	адресу электронной почты <B>email</B>.
	Результаты поиска попадают в вектор
	<B>result_vec</B>.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>vector&lt;ICQKidShortUserInfo&gt;
	search_vec;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.searchByMail(&quot;john@isp.com&quot;, search_vec)) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>else</B></FONT></FONT></P>
	<P>    <FONT FACE="Courier New"><FONT SIZE=2><B>for (size_t i=0;
	i&lt;search_vec.size(); ++i)</B></FONT></FONT></P>
	<P>        <FONT FACE="Courier New"><FONT SIZE=2><B>MyPrintShortInfo(search_vec[i]);</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.5.searchByUIN|outline"></A> 5.5.searchByUIN</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	searchByUIN(string uin, vector&lt;ICQKidShortUserInfo&gt; &amp;
	result_vec)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод ищет контакт с
	UIN'ом <B>uin</B>. Результаты поиска попадают
	в вектор <B>result_vec</B>.</FONT></P>
</DL>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>vector&lt;ICQKidShortUserInfo&gt;
	search_vec;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.searchByUIN(&quot;123456&quot;, search_vec)) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>else</B></FONT></FONT></P>
	<P>    <FONT FACE="Courier New"><FONT SIZE=2><B>for (size_t i=0;
	i&lt;search_vec.size(); ++i)</B></FONT></FONT></P>
	<P>        <FONT FACE="Courier New"><FONT SIZE=2><B>MyPrintShortInfo(search_vec[i]);</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.6.searchByWhitePages|outline"></A> 5.6.searchByWhitePages</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	searchByWhitePages(ICQKidFullUserInfo &amp; info,
	vector&lt;ICQKidShortUserInfo&gt; &amp; result_vec)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод ищет контакты,
	соответствующие информации из структуры
	<B>info</B>. Результаты поиска попадают в
	вектор <B>result_vec</B>. В аргументе <B>info</B>
	обрабатываются следующие поля:</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Firstname</B> – Имя, если
	пустая строка – любое</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Lastname</B> – Фамилия, если
	пустая строка – любая</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Nickname</B> – Ник, если
	пустая строка – любой</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Email</B> - E-mail адрес, если
	пустая строка – любой</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Homecity</B> - Город, если
	пустая строка – любой</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Homestate</B> – Штат/регион,
	если пустая строка – любой</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Homecountry</B> – Код страны
	(из icqkid2_constants.h), если 0 - любая</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Workcompany</B> - Компания,
	если пустая строка – любая</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Workdepartment</B> - Отдел, если
	пустая строка – любой</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Workposition</B> - Должность,
	если пустая строка – любая</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Workoccupation</B> – Код должности
	(из icqkid2_constants.h), если 0 - любая</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Searchkey</B> – Ключевые
	слова при поиске, если пустая строка –
	не учитывается</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Minage</B> – Минимальный
	возраст, если меньше 13 – не учитывается</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Maxage</B> – Максимальный
	возраст, если 0 - не учитывается</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Gender</B> – Пол (из
	icqkid2_constants.h), если 0 - любой</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Maritalstatus</B> – Код состояния
	в браке (из icqkid2_constants.h), если 0 - любой</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Language1</B> – Код языка (из
	icqkid2_constants.h), если 0 - любой</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Past1category</B> – Код занятий
	в прошлом  (из icqkid2_constants.h), если 0 - любой</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Past1</B> – Описание для
	<B>Past1category</B> (возможен набор через &quot;,&quot;),
	если пустая строка – не учитывается</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Interest1category</B> – Код
	интересов (из icqkid2_constants.h), если 0 - любой</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Interest1</B> - Описание для
	<B>Interest1category</B> (возможен набор через
	&quot;,&quot;),  если пустая строка – не
	учитывается</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Affiliation1category</B> – Код
	организации (из icqkid2_constants.h), если 0 -
	любой</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Affiliation1</B> - Описание для
	<B>Affiliation1category</B> (возможен набор через
	&quot;,&quot;),  если пустая строка – не
	учитывается</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Homepagecategory</B> – Категория
	домашней страницы, если 0 - любая</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Homepagekeywords –</B> Ключевые
	слова при поиске домашней страницы,
	если пустая строка – не учитывается</FONT></P>
	<DD><P><FONT FACE="Arial"><B>Searchonline</B> – Если 1 то
	искать пользователей только в статусе
	Online, если 0 – искать всех</FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>vector&lt;ICQKidShortUserInfo&gt;
	search_result_vec;</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>ICQKidFullUserInfo
	search_info;</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>search_info.Homecountry=INFO_COUNTRY_USA;</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>search_info.Gender=INFO_GENDER_FEMALE;</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>search_info.Maritalstatus=INFO_MARITAL_SINGLE;</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>search_info.Language1=INFO_LANG_ENGLISH;</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>search_info.Minage=18;</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>search_info.Maxage=40;</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.searchByWhitePages(search_info, search_result_vec)) {...</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>else</B></FONT></FONT></P>
	<DD><P>  <FONT FACE="Courier New"><FONT SIZE=2><B>for (size_t i=0;
	i&lt;search_result_vec.size(); ++i)</B></FONT></FONT></P>
	<DD><P>   <FONT FACE="Courier New"><FONT SIZE=2><B>printShortInfo(search_result_vec[i]);</B></FONT></FONT></P>
</DL>
<H2><A NAME="5.7.addContact|outline"></A> 5.7.addContact</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool addContact(string
	uin, string nick, string groupname, uint16_t * retflag=NULL)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод добавляет контакт с
	UIN'ом <B>uin</B> и ником <B>nick</B> в существующую
	группу с именем <B>groupname</B>. Если контакт
	требует авторизации, он автоматически
	добавляется, как ожидающий авторизации.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.
	Если указатель <B>retflag</B> не равен <B>NULL</B>,
	то в переменную <B>*retflag</B> заносится
	расширенный статус выполнения операции,
	возможные значения которого описаны
	ниже.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.addContact(&quot;777888&quot;, &quot;Icefox&quot;,
	&quot;General&quot;)) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint16_t retflag;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.addContact(&quot;777888&quot;, &quot;Icefox&quot;, &quot;General&quot;,
	&amp;retflag)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.8.removeContact|outline"></A> 5.8.removeContact</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	removeContact(string uin, uint16_t * retflag=NULL)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод удаляет существующий
	контакт с UIN'ом <B>uin</B>.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.
	Если указатель <B>retflag</B> не равен <B>NULL</B>,
	то в переменную <B>*retflag</B> заносится
	расширенный статус выполнения операции,
	возможные значения которого описаны
	ниже.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.removeContact(&quot;777888&quot;)) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint16_t retflag;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.removeContact(&quot;777888&quot;, &amp;retflag)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.9.renameContact|outline"></A> 5.9.renameContact</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	renameContact(string uin, string nick, uint16_t * retflag=NULL)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод переименовывает
	существующий контакт с UIN'ом <B>uin</B>,
	присваивая ему новый никнэйм <B>nick</B>.
	Контакты, ожидающие авторизации, не
	могут быть переименованы. Такие контакты
	этот метод сначала удаляет, а потом
	добавляет с новым никнэймом. При этом
	у таких контактов меняется идентификатор.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.
	Если указатель <B>retflag</B> не равен <B>NULL</B>,
	то в переменную <B>*retflag</B> заносится
	расширенный статус выполнения операции,
	возможные значения которого описаны
	ниже.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.renameContact(&quot;777888&quot;, &quot;Firewolf&quot;)) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint16_t retflag;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.removeContact(&quot;777888&quot;, &quot;Firewolf&quot;,
	&amp;retflag)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.10.addContacts/removeContacts/renameContacts|outline"></A>
 5.10.addContacts/removeContacts/renameContacts</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	addContacts(vector&lt;SSITransactContact&gt; &amp; cont_vec);</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	removeContacts(vector&lt;SSITransactContact&gt; &amp; cont_vec);</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	renameContacts(vector&lt;SSITransactContact&gt; &amp; cont_vec);</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Смысл этих методов
	аналогичен вышеописанным аналогам, с
	той лишь разницей, что данные методы
	предназначены для оперирования списками
	контактов в пределах одной транзакции.
	Частые многократные вызовы методов
	единичного добавления/удаления/переименования
	контактов приводят к блокировке со
	стороны ICQ-сервера.</FONT></P>
	<DD><P><FONT FACE="Arial">Методы оперируют векторами
	структур <B>SSITransactContact</B>, содержащих
	следующие поля:</FONT></P>
	<DD><P><FONT FACE="Arial"><B>string uin</B> - Участвует
	всегда</FONT></P>
	<DD><P><FONT FACE="Arial"><B>string nick</B> – Участвует
	при добавлении и переименовании</FONT></P>
	<DD><P><FONT FACE="Arial"><B>string groupname</B> – Участвует
	при добавлении</FONT></P>
	<DD><P><FONT FACE="Arial"><B>uint16_t retflag</B> – Здесь
	сохраняется статус операции для каждой
	записи</FONT></P>
	<DD><P><FONT FACE="Arial">При успешном прохождении
	транзакции возвращается <B>true</B>, иначе
	– <B>false</B>.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>vector&lt;SSITransactContact&gt;
	cont_vec;</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>SSITransactContact
	c1 = {&quot;123456&quot;, &quot;Icefox&quot;, &quot;General&quot;,
	0};</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>SSITransactContact
	c2 = {&quot;654321&quot;, &quot;Betty&quot;, &quot;General&quot;,
	0};</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>cont_vec.push_back(c1);</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>cont_vec.push_back(c2);</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.addContacts(cont_vec)) {...</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(cont_vec[0].retflag!=SSI_EDIT_OK) {...</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(cont_vec[1].retflag!=SSI_EDIT_OK) {...</B></FONT></FONT></P>
</DL>
<H2><A NAME="5.11.addBLMContact|outline"></A> 5.11.addBLMContact</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	addBLMContact(string uin)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод добавляет контакт с
	UIN'ом <B>uin</B> во временный контакт-лист
	(Buddy List), не добавляя его в контакт-лист
	на стороне сервера (SSI). После завершения
	сессии временный контакт-лист
	уничтожается. Для контактов из временного
	контакт-листа так же приходят оповещения
	<B>onUserNotify</B>, даже в том случае, когда
	контакт требует авторизации. Контакты
	могут одновременно присутствовать и
	в SSI-листе и в BLM-листе.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.addBLMContact(&quot;123456&quot;)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.12.removeBLMContact|outline"></A> 5.12.removeBLMContact</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	removeBLMContact(string uin)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод удаляет контакт с
	UIN'ом <B>uin</B> из временного контакт-листа
	(Buddy List).</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.removeBLMContact(&quot;123456&quot;)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.13.addBLMContacts|outline"></A> 5.13.addBLMContacts</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	addBLMContacts(vector&lt;string&gt; &amp; uins)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод добавляет все контакты
	из вектора <B>uins</B> во временный контакт-лист
	(Buddy List) за один раз.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>vector&lt;string&gt;
	blm_uins;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>blm_uins.push_back(&quot;123456&quot;);</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>blm_uins.push_back(&quot;789012&quot;);</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.addBLMContacts(blm_uins)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.14.removeBLMContacts|outline"></A> 5.14.removeBLMContacts</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	removeBLMContacts(vector&lt;string&gt; &amp; uins)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод удаляет все контакты,
	содержащиеся в векторе <B>uins</B> из
	временного контакт-листа (Buddy List) за
	один раз.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>vector&lt;string&gt;
	blm_uins;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>blm_uins.push_back(&quot;123456&quot;);</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>blm_uins.push_back(&quot;789012&quot;);</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.removeBLMContacts(blm_uins)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.15.addGroup|outline"></A> 5.15.addGroup</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool addGroup(string
	groupname, uint16_t * retflag=NULL)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод добавляет в контакт-лист
	новую группу с уникальным именем
	<B>groupname</B>.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.
	Если указатель <B>retflag</B> не равен <B>NULL</B>,
	то в переменную <B>*retflag</B> заносится
	расширенный статус выполнения операции,
	возможные значения которого описаны
	ниже.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.addGroup(&quot;Family666&quot;)) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint16_t retflag;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.addGroup(&quot;Family666&quot;, &amp;retflag)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.16.removeGroup|outline"></A> 5.16.removeGroup</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool removeGroup(string
	groupname, uint16_t * retflag=NULL)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод удаляет из контакт-листа
	группу с именем <B>groupname</B>. При этом также
	удаляются все контакты, входящие в эту
	группу.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.
	Если указатель <B>retflag</B> не равен <B>NULL</B>,
	то в переменную <B>*retflag</B> заносится
	расширенный статус выполнения операции,
	возможные значения которого описаны
	ниже.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.removeGroup(&quot;Family666&quot;)) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint16_t retflag;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.removeGroup(&quot;Family666&quot;, &amp;retflag)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.17.renameGroup|outline"></A> 5.17.renameGroup</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool renameGroup(string
	groupname, string newname, uint16_t * retflag=NULL)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод переименовывает
	существующую группу с именем <B>groupname</B>,
	присваивая ей новое имя <B>newname</B>.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.
	Если указатель <B>retflag</B> не равен <B>NULL</B>,
	то в переменную <B>*retflag</B> заносится
	расширенный статус выполнения операции,
	возможные значения которого описаны
	ниже.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.renameGroup(&quot;Family666&quot;, &quot;Family777&quot;))
	{...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint16_t retflag;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.renameGroup(&quot;Family666&quot;, &quot;Family777&quot;,
	&amp;retflag)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.18.updateContactList|outline"></A> 5.18.updateContactList</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	updateContactList(void)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод запрашивает с сервера
	копию контакт листа. Первый раз это
	происходит при подключении. Все
	модификации контакт-листа автоматически
	отражаются на локальной копии и не
	требуют вызова этого метода для
	синхронизации.</FONT></P>
	<P><FONT FACE="Arial">При успешном запросе
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.updateContactList()) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.19.findCLUIN|outline"></A> 5.19.findCLUIN</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>int findCLUIN(string
	uin)</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>int findCLUIN(uint16_t
	item_id);</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод возвращает позицию
	контакта в векторе <B>ContactListUins</B>. Поиск
	контакта ведется по UIN'у <B>uin</B>, либо по
	идентификатору <B>item_id</B>.</FONT></P>
	<P><FONT FACE="Arial">В случае, если такого
	контакта нет, возвращается -1.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>int pos;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	((pos=miif.findCLUIN(&quot;654321&quot;))&lt;0) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	((pos=miif.findCLUIN(0x1c23))&lt;0) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.20.findCLGroup|outline"></A> 5.20.findCLGroup</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>int findCLGroup(string
	groupname)</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>int findCLGroup(uint16_t
	group_id)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод возвращает позицию
	группы в векторе <B>ContactListGroups</B>. Поиск
	группы ведется по имени <B>groupname</B>, либо
	по идентификатору <B>group_id</B>.</FONT></P>
	<P><FONT FACE="Arial">В случае, если такой группы
	нет, возвращается -1.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>int pos;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	((pos=miif.findCLGroup(&quot;General&quot;))&lt;0) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	((pos=miif.findCLGroup(0x0002))&lt;0) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="5.21.Векторы ContactListUins и ContactListGroups|outline"></A>
 5.21.Векторы ContactListUins и ContactListGroups</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>vector&lt;SSIUINEntry&gt;
	ContactListUins</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>vector&lt;SSIGroupEntry&gt;
	ContactListGroups</B></FONT></FONT></P>
	<P><FONT FACE="Arial">В целях экономии трафика
	и упрощения работы с контакт-листом,
	он содержится в локальных векторах, по
	одному для контактов и для групп. Вектора
	находятся в зоне доступа <B>public</B>, и
	доступны напрямую. Формат структур,
	содержащихся в векторах, описан ниже.</FONT></P>
</OL>
<H2><A NAME="5.22.Структура ICQKidShortUserInfo|outline"></A>
 5.22.Структура ICQKidShortUserInfo</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Arial">Данная структура заполняется
	методом <B>getUserInfo</B> и содержит следующие
	поля:</FONT></P>
	<P><FONT FACE="Arial"><B><FONT SIZE=2><FONT FACE="Courier New">string
	Uin</FONT></FONT></B> – UIN</FONT></P>
	<P><FONT FACE="Arial"><B><FONT SIZE=2><FONT FACE="Courier New">string
	Nickname</FONT></FONT></B> – никнэйм</FONT></P>
	<P><FONT FACE="Arial"><B><FONT SIZE=2><FONT FACE="Courier New">string
	Firstname</FONT></FONT></B> – имя</FONT></P>
	<P><FONT FACE="Arial"><B><FONT SIZE=2><FONT FACE="Courier New">string
	Lastname</FONT></FONT></B> - фамилия</FONT></P>
	<P><FONT FACE="Arial"><B><FONT SIZE=2><FONT FACE="Courier New">string
	Email</FONT></FONT></B> – адрес электронной почты</FONT></P>
	<P><FONT FACE="Arial"><B><FONT SIZE=2><FONT FACE="Courier New">int
	Gender</FONT></FONT></B> - возраст</FONT></P>
	<P><FONT FACE="Arial"><B><FONT SIZE=2><FONT FACE="Courier New">bool
	Needauth</FONT></FONT></B> – нужна ли авторизация
	при добавлении</FONT></P>
	<P><FONT FACE="Arial"><B><FONT SIZE=2><FONT FACE="Courier New">uint32_t
	Status</FONT></FONT></B> – статус контакта на
	момент запроса информации (STATUS_ONLINE,
	etc)</FONT></P>
	<P><FONT FACE="Arial"><B><FONT SIZE=2><FONT FACE="Courier New">uint16_t
	Age</FONT></FONT></B> – возраст</FONT></P>
</OL>
<H2><A NAME="5.23.Структура SSIUINEntry|outline"></A> 5.23.Структура
SSIUINEntry</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Arial">Данная структура является
	элементом локального вектора контактов
	<B>ContactListUins</B>. Структура содержит
	следующие поля:</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>string uin</B><FONT SIZE=3><FONT FACE="Times New Roman">
	– UIN</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>string nick</B><FONT SIZE=3><FONT FACE="Times New Roman">
	- никнэйм</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint16_t groupid</B><FONT SIZE=3><FONT FACE="Times New Roman">
	– идентификатор группы</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>string groupname</B><FONT SIZE=3><FONT FACE="Times New Roman">
	– имя группы</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint16_t itemid</B><FONT SIZE=3><FONT FACE="Times New Roman">
	– идентификатор контакта</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool waitauth</B><FONT SIZE=3><FONT FACE="Times New Roman">
	– контакт ожидает авторизации</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint32_t
	last_internal_ip</B><FONT SIZE=3><FONT FACE="Times New Roman"> –
	последний известный внутренний IP-адрес
	клиента</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint32_t
	last_internal_port</B><FONT SIZE=3><FONT FACE="Times New Roman"> –
	последний известный внутренний TCP-порт
	клиента</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint32_t
	last_external_ip</B><FONT SIZE=3><FONT FACE="Times New Roman"> –
	последний известный внешний IP-адрес
	клиента</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><B><FONT SIZE=2><FONT FACE="Courier New">bool
	have_icon</FONT></FONT></B> – есть ли возможность
	скачать иконку</FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><B><FONT SIZE=2><FONT FACE="Courier New">uint16_t
	icon_id</FONT></FONT> –</B> ID иконки</FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><B><FONT SIZE=2><FONT FACE="Courier New">uint8_t
	icon_flags</FONT></FONT></B> – флаги иконки</FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><B><FONT SIZE=2><FONT FACE="Courier New">uint8_t
	icon_md5_hash[16]</FONT></FONT></B> – MD5 хэш иконки</FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><B><FONT SIZE=2><FONT FACE="Courier New">vector&lt;uint8_t&gt;
	icon_data</FONT></FONT></B> – сюда закачивается
	иконка</FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><B><FONT SIZE=2><FONT FACE="Courier New">uint32_t
	online_status</FONT></FONT></B> – Online статус контакта</FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><B><FONT SIZE=2><FONT FACE="Courier New">uint32_t
	status_modifiers</FONT></FONT></B> – модификаторы
	статуса (STATUS_BIRTHDAY и прочие)</FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><B><FONT SIZE=2><FONT FACE="Courier New">bool
	invisible</FONT></FONT></B> – невидим ли контакт</FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><B><FONT SIZE=2><FONT FACE="Courier New">size_t
	xStatus</FONT></FONT></B> – xStatus (XtraZ расширение,
	возможные значения в <B>icqkid2_constants.h</B>)</FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><B><FONT SIZE=2><FONT FACE="Courier New">string
	xStatusTitle</FONT></FONT></B>  - заголовок xStatus'а</FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><B><FONT SIZE=2><FONT FACE="Courier New">string
	xStatusDescription</FONT></FONT></B> – описание xStatus'а</FONT></FONT></P>
	<P><FONT FACE="Times New Roman"><FONT SIZE=3><FONT SIZE=2><FONT FACE="Courier New"><B>bool
	isBLM</B> </FONT></FONT>– этот контакт добавлен
	через BLM?</FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool srv_relay_cap</B><FONT SIZE=3><FONT FACE="Times New Roman">
	- ICQ Server Relaying, <FONT SIZE=3><FONT FACE="Times New Roman">контакт</FONT></FONT>
	может принимать сообщения по каналу 2
	(цвет, UTF-8 и т.д)</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool unicode_cap</B><FONT SIZE=3><FONT FACE="Times New Roman">
	– <FONT SIZE=3><FONT FACE="Times New Roman">контакт</FONT></FONT>
	может принимать сообщения в кодировках
	USC2-BE и UTF-8</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>string
	AutoAwayMessageText</B><FONT SIZE=3><FONT FACE="Times New Roman"> –
	последнее принятое от <FONT SIZE=3><FONT FACE="Times New Roman">контакта</FONT></FONT>
	Away-сообщение</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>string
	AutoBusyMessageText</B><FONT SIZE=3><FONT FACE="Times New Roman"> -
	последнее принятое от <FONT SIZE=3><FONT FACE="Times New Roman">контакта</FONT></FONT>
	Busy-сообщение</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>string
	AutoNotAvailableMessageText</B><FONT SIZE=3><FONT FACE="Times New Roman">
	- последнее принятое от контакта
	NA-сообщение</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>string
	AutoDoNotDisturbMessageText</B><FONT SIZE=3><FONT FACE="Times New Roman">
	- последнее принятое от <FONT SIZE=3><FONT FACE="Times New Roman">контакта
	</FONT></FONT>DND-сообщение</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>string
	AutoFreeForChatMessageText</B><FONT SIZE=3><FONT FACE="Times New Roman">
	- последнее принятое от <FONT SIZE=3><FONT FACE="Times New Roman">контакта</FONT></FONT>
	FFC-сообщение</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint32_t online_since</B><FONT SIZE=3><FONT FACE="Times New Roman">
	– время выхода <FONT SIZE=3><FONT FACE="Times New Roman">контакта</FONT></FONT>
	в сеть в формате unix time, если 0 значит
	неизвестно</FONT></FONT></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint32_t idle_since</B><FONT SIZE=3><FONT FACE="Times New Roman">
	– время с которого <FONT SIZE=3><FONT FACE="Times New Roman">контакт</FONT></FONT>
	занят в формате unix time, если 0 значит
	неизвестно</FONT></FONT></FONT></FONT></P>
</OL>
<H2><A NAME="5.24.Структура SSIGroupEntry|outline"></A> 5.24.Структура
SSIGroupEntry</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Arial">Данная структура является
	элементом локального вектора групп
	<B>ContactListGroups</B>. Структура содержит
	следующие поля:</FONT></P>
	<P><FONT FACE="Arial"><B><FONT SIZE=2><FONT FACE="Courier New">uint16_t
	id</FONT></FONT></B> - <FONT SIZE=3><FONT FACE="Times New Roman">идентификатор
	группы</FONT></FONT></FONT></P>
	<P><FONT FACE="Arial"><B><FONT SIZE=2><FONT FACE="Courier New">string
	name</FONT></FONT></B> – имя группы</FONT></P>
</OL>
<H2><A NAME="5.25.Расширенные коды ошибок|outline"></A>
 5.25.Расширенные коды ошибок</I></FONT></FONT></H2>
<OL START=5>
	<P><FONT FACE="Arial">Методы <B>addContact, removeContact,
	renameContact, addGroup, removeGroup</B> и <B>renameGroup</B> имеют
	возможность получать расширенные
	статус выполнения. Этот статус может
	иметь следующие значения:</FONT></P>
	<P><FONT FACE="Arial"><B>SSI_EDIT_OK</B> – успешное
	завершение операции</FONT></P>
	<P><FONT FACE="Arial"><B>SSI_EDIT_ERR_NOTFOUND</B> – объект
	не найден</FONT></P>
	<P><FONT FACE="Arial"><B>SSI_EDIT_ERR_EXIST</B> – объект уже
	существует</FONT></P>
	<P><FONT FACE="Arial"><B>SSI_EDIT_ERR_NETWORK</B> – ошибка
	на пакетно-сетевом уровне</FONT></P>
	<P><FONT FACE="Arial"><B>SSI_EDIT_ERR_CANTADD</B> – невозможно
	добавить объект</FONT></P>
	<P><FONT FACE="Arial"><B>SSI_EDIT_ERR_LIMIT</B> – превышение
	лимита</FONT></P>
	<P><FONT FACE="Arial"><B>SSI_EDIT_ERR_AIMLIST</B> – попытка
	добавления ICQ-контакта в AIM-контакт-лист,
	или наоборот</FONT></P>
	<P><FONT FACE="Arial"><B>SSI_EDIT_ERR_NEEDAUTH</B> – контакт
	требует авторизации</FONT></P>
</OL>
<H1><A NAME="6.Авторизация|outline"></A> 6.Авторизация</FONT></FONT></H1>
<OL START=6>
	<P><FONT FACE="Arial">Здесь описаны методы для
	запроса, подтверждения и отклонения
	авторизации.</FONT></P>
</OL>
<H2><A NAME="6.1.authRequest|outline"></A> 6.1.authRequest</I></FONT></FONT></H2>
<OL START=6>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool authRequest(string
	uin, string text)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод запрашивает авторизацию
	у пользователя с UIN'ом <B>uin</B>, добавляя
	описание <B>text</B>.</FONT></P>
	<P><FONT FACE="Arial">При успешной отправке
	запроса возвращается <B>true</B>, иначе –
	<B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.authRequest(&quot;777888&quot;, &quot;Please, authorize
	me!&quot;)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="6.2.authReply|outline"></A> 6.2.authReply</I></FONT></FONT></H2>
<OL START=6>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool authReply(string
	uin, string text, uint8_t aflag)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод позволяет послать
	подтверждение или отказ (в зависимости
	от значения <B>aflag</B>) в авторизации
	пользователю с UIN'ом <B>uin</B>, добавляя
	описание <B>text</B>. Возможные  значения
	<B>aflag</B> описаны ниже.</FONT></P>
	<P><FONT FACE="Arial">При успешной отправке
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.authReply(&quot;123456&quot;, &quot;Ok, get it&quot;,
	AUTH_ACCEPTED)) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.authReply(&quot;123456&quot;, &quot;Sorry&quot;,
	AUTH_DECLINED)) {...</B></FONT></FONT></P>
</OL>
<H2><A NAME="6.3.Коды авторизации|outline"></A> 6.3.Коды
авторизации</I></FONT></FONT></H2>
<OL START=6>
	<P><FONT FACE="Arial">Следующие коды авторизации
	используются методом <B>authReply</B> и приходят
	в коллбэк <B>onAuthReply</B>:</FONT></P>
	<P><FONT FACE="Arial"><B>AUTH_DECLINED</B> – в авторизации
	отказано</FONT></P>
	<P><FONT FACE="Arial"><B>AUTH_ACCEPTED</B> – дана авторизация</FONT></P>
</OL>
<H1><A NAME="7.Управление настройками конфиденциальности|outline"></A>
 7.Управление настройками конфиденциальности</FONT></FONT></H1>
<H2><A NAME="7.1.addVisible|outline"></A> 7.1.addVisible</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	addVisible(string uin, string nick=&quot;&quot;)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод добавляет контакт
	с UIN'ом <B>uin</B> в visible-лист на стороне
	сервера и в вектор <B>VisibleList</B>. Вы будете
	видимы для данного контакта даже в
	состоянии невидимости (при соответствующих
	настройках конфиденциальности). Аргумент
	<B>nick</B> так же сохраняется на стороне
	сервера, но не несет какой-то специальной
	алгоритмической нагрузки, служит для
	удобства.</FONT></P>
	<DD><P><FONT FACE="Arial">При соединении с сервером
	visible-лист загружается в вектор
	<B>vector&lt;SSIUINEntry&gt; VisibleList</B>, находящийся
	в <B>public</B>-зоне класса <B>ICQKid2</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">При удачном добавлении
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!addVisible(&quot;123456&quot;)) {...</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!addVisible(&quot;123456&quot;, &quot;Lilu-visible&quot;)) {...</B></FONT></FONT></P>
</DL>
<H2><A NAME="7.2.removeVisible|outline"></A> 7.2.removeVisible</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	removeVisible(string uin, string nick=&quot;&quot;)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод удаляет контакт с
	UIN'ом <B>uin</B> из visible-листа на стороне
	сервера и из вектора <B>VisibleList</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">При удачном удалении
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!removeVisible(&quot;123456&quot;)) {...</B></FONT></FONT></P>
</DL>
<H2><A NAME="7.3.addInvisible|outline"></A> 7.3.addInvisible</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	addInvisible(string uin, string nick=&quot;&quot;)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод добавляет контакт
	с UIN'ом <B>uin</B> в invisible-лист на стороне
	сервера и в вектор <B>InvisibleList</B>. Вы будете
	невидимы для данного контакта в любом
	состоянии (при соответствующих настройках
	конфиденциальности). Аргумент <B>nick</B>
	так же сохраняется на стороне сервера,
	но не несет какой-то специальной
	алгоритмической нагрузки, служит для
	удобства.</FONT></P>
	<DD><P><FONT FACE="Arial">При соединении с сервером
	invisible-лист загружается в вектор
	<B>vector&lt;SSIUINEntry&gt; InvisibleList</B>, находящийся
	в <B>public</B>-зоне класса <B>ICQKid2</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">При удачном добавлении
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!addInvisible(&quot;654321&quot;)) {...</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!addInvisible(&quot;654321&quot;, &quot;Ice-invisible&quot;)) {...</B></FONT></FONT></P>
</DL>
<H2><A NAME="7.4.removeInvisible|outline"></A> 7.4.removeInvisible</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	removeInvisible(string uin, string nick=&quot;&quot;)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод удаляет контакт с
	UIN'ом <B>uin</B> из invisible-листа на стороне
	сервера и из вектора <B>InvisibleList</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">При удачном удалении
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!removeInvisible(&quot;654321&quot;)) {...</B></FONT></FONT></P>
</DL>
<H2><A NAME="7.5.addIgnore|outline"></A> 7.5.addIgnore</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	addIgnore(string uin, string nick=&quot;&quot;)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод добавляет контакт
	с UIN'ом <B>uin</B> в ignore-лист на стороне
	сервера и в вектор <B>IgnoreList</B>. Вы не
	будете получать никаких сообщений от
	данного контакта. Аргумент <B>nick</B> так
	же сохраняется на стороне сервера, но
	не несет какой-то специальной
	алгоритмической нагрузки, служит для
	удобства.</FONT></P>
	<DD><P><FONT FACE="Arial">При соединении с сервером
	ignore-лист загружается в вектор
	<B>vector&lt;SSIUINEntry&gt; IgnoreList</B>, находящийся
	в <B>public</B>-зоне класса <B>ICQKid2</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">При удачном добавлении
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!addIgnore(&quot;987654&quot;)) {...</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!addIgnore(&quot;987654&quot;, &quot;John-ignore&quot;)) {...</B></FONT></FONT></P>
</DL>
<H2><A NAME="7.6.removeIgnore|outline"></A> 7.6.removeIgnore</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	removeIgnore(string uin, string nick=&quot;&quot;)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод удаляет контакт с
	UIN'ом <B>uin</B> из ignore-листа на стороне
	сервера и из вектора <B>IgnoreList</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">При удачном удалении
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!removeIgnore(&quot;987654&quot;)) {...</B></FONT></FONT></P>
</DL>
<H2><A NAME="7.7.setMyPrivacyStatus|outline"></A> 7.7.setMyPrivacyStatus</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	setMyPrivacyStatus(uint8_t stat)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод устанавливает
	настройки конфиденциальности на стороне
	серевера согласно аргументу <B>stat</B>,
	который может принимать следующие
	значения:</FONT></P>
	<DD><P><FONT FACE="Arial"><B>PRIV_ALL_CAN_SEE</B> – видим для
	всех</FONT></P>
	<DD><P><FONT FACE="Arial"><B>PRIV_NOBODY_CAN_SEE</B> – невидим
	для всех</FONT></P>
	<DD><P><FONT FACE="Arial"><B>PRIV_VISLIST_CAN_SEE</B> – видим
	только для visible-листа</FONT></P>
	<DD><P><FONT FACE="Arial"><B>PRIV_INVISLIST_CANNOT_SEE</B> – видим
	для всех кроме invisible-листа</FONT></P>
	<DD><P><FONT FACE="Arial"><B>PRIV_CONTACTLIST_CAN_SEE</B> – видим
	только для контакт-листа</FONT></P>
	<DD><P><FONT FACE="Arial">Если настройки установились
	удачно возвращается <B>true</B>, иначе –
	<B>false</B>.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!setMyPrivacyStatus(PRIV_INVISLIST_CANNOT_SEE)) {...</B></FONT></FONT></P>
</DL>
<H2><A NAME="7.8.getMyPrivacyStatus|outline"></A> 7.8.getMyPrivacyStatus</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>uint8_t
	getMyPrivacyStatus(void)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод возвращает текущие
	настройки конфиденциальности, возможные
	значения перечислены в предыдущем
	пункте.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.doConnect();</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>uint8_t
	my_priv_stat=miif.getMyPrivacyStatus();</B></FONT></FONT></P>
</DL>
<H1><A NAME="8.Посылка данных|outline"></A> 8.Посылка
данных</FONT></FONT></H1>
<OL START=8>
	<P><FONT FACE="Arial">Здесь описаны методы посылки
	данных клиентом.</FONT></P>
</OL>
<H2><A NAME="8.1.sendMessage|outline"></A> 8.1.sendMessage</I></FONT></FONT></H2>
<OL START=8>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	sendMessage(ICQKid2Message amsg)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод посылает сообщение,
	описанное объектом <B>amsg</B>.</FONT></P>
	<P><FONT FACE="Arial">Класс <B>ICQKid2Message</B> предназначен
	для отсылки и приема сообщений и имеет
	следующие методы и поля:</FONT></P>
	<P><FONT FACE="Arial"><B>ICQKid2Message(void)</B> – конструктор
	по умолчанию, устанавливает все поля
	те же значения что и следующий конструктор,
	за исключением <B>uin </B>и <B>text</B>, они не
	инициализируются и остаются пустыми
	строками.</FONT></P>
	<P><FONT FACE="Arial"><B>ICQKid2Message(string auin, string atext,
	EncodeType aenc_type=LOCAL8BIT, uint16_t acodepage=0, bool
	ais_offline=false, uint8_t * atext_color=NULL, uint8_t *
	abg_color=NULL)</B> – конструктор для быстрого
	создания объекта с соответствующими
	полями по умолчанию.</FONT></P>
	<P><FONT FACE="Arial"><B>string uin</B> – для метода
	<B>sendMessage()</B> означает, кому отправить
	сообщение, для коллбэков <B>onIncomingMsg()</B>
	и <B>onIncomingAutoStatusMsg()</B> - от кого пришло
	сообщение.</FONT></P>
	<P><FONT FACE="Arial"><B>string text</B> – текст сообщения.</FONT></P>
	<P><FONT FACE="Arial"><B>uint8_t text_color[4]</B> – цвет
	текста в формате RGBN (если не UTF-8,
	игнорируется)</FONT></P>
	<P><FONT FACE="Arial"><B>uint8_t bg_color[4]</B> – цвет фона
	в формате RGBN (если не UTF-8, игнорируется)</FONT></P>
	<P><FONT FACE="Arial"><B>EncodeType enc_type</B> – тип
	кодирования, возможны следующие
	значения:</FONT></P>
	<P>  <FONT FACE="Arial"><B>USASCII</B> – 7-битное сообщение,
	содержащее только латинские символы</FONT></P>
	<P>  <FONT FACE="Arial"><B>LOCAL8BIT</B> – 8-битное
	сообщение с кодовой страницей <B>codepage</B>.</FONT></P>
	<P>  <FONT FACE="Arial"><B>UCS2BE</B> – сообщение в
	кодировке UCS2-BE</FONT></P>
	<P>  <FONT FACE="Arial"><B>UTF8</B> – сообщение в
	кодировке UTF-8</FONT></P>
	<P><FONT FACE="Arial">Библиотека не перекодирует
	текст сообщения, в случае надобности
	приложение должно делать это
	самостоятельно.</FONT></P>
	<P><FONT FACE="Arial"><B>uint16_t codepage</B> – кодовая
	страница для кодирования <B>LOCAL8BIT</B> (на
	практике все клиенты ставят туда 0, вы
	можете сломать эту тенденцию).</FONT></P>
	<P><FONT FACE="Arial"><B>bool is_offline</B> – для коллбэка
	<B>onIncomingMsg()</B>, <B>true</B> если принято
	сообщение, отправленное, когда клиент
	был в оффлайне.</FONT></P>
	<P><FONT FACE="Arial"><B>time_t timestamp</B> – для коллбэка
	<B>onIncomingMsg(), </B>время отправки сообщения.</FONT></P>
	<P><FONT FACE="Arial">Вы можете отправлять
	сообщения с кодированием <B>USASCII</B> и
	<B>LOCAL8BIT</B> любому клиенту. Вы можете
	отправлять сообщения с кодированием
	<B>UCS2BE</B> только клиентам, поддерживающим
	юникод (<B>ContactListUins[xxx].unicode_cap==true</B>). Вы
	можете отправлять сообщения с кодированием
	<B>UTF8</B> только клиентам, поддерживающим
	юникод и &quot;ICQ Server Relaying&quot;
	(<B>ContactListUins[xxx].unicode_cap==true &amp;&amp;
	ContactListUins[xxx].srv_relay_cap==true</B>). Если вы
	нарушаете эти правила, метод не передаст
	сообщение и вернет <B>false</B>.</FONT></P>
	<P><FONT FACE="Arial">При успешной отправке
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.sendMessage(ICQKid2Message(&quot;444555&quot;, &quot;Hello,
	friend!&quot;))) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.sendMessage(ICQKid2Message(&quot;444555&quot;, &quot;Привет!&quot;,
	ICQKid2::ICQKid2Message::LOCAL8BIT, 1251))) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint8_t
	text_color[]={0x00, 0xff, 0xff, 0x00};</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>uint8_t
	bg_color[]={0x00, 0x00, 0x4f, 0x00};</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(ContactListUins[cl_ind].unicode_cap &amp;&amp;
	ContactListUins[cl_ind].srv_relay_cap)</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>miif.sendMessage(ICQKid2Message(ContactListUins[cl_ind].uin,
	my_utf8_text, ICQKid2::ICQKid2Message::UTF8, 0, false, text_color,
	bg_color));</B></FONT></FONT></P>
</OL>
<H2><A NAME="8.2.sendMTN|outline"></A> 8.2.sendMTN</I></FONT></FONT></H2>
<OL START=8>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool sendMTN(string to,
	uint16_t atype)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод посылает уведомление
	о наборе текста (mini-type-notification MTN)
	пользователю с UIN'ом <B>to</B>. Аргумент
	<B>atype</B> принимает следующие значения:</FONT></P>
	<P><FONT FACE="Arial"><B>MTN_BEGIN</B> – начат набор
	текста</FONT></P>
	<P><FONT FACE="Arial"><B>MTN_TYPED</B> – текст набран</FONT></P>
	<P><FONT FACE="Arial"><B>MTN_FINISH</B> – текст отослан</FONT></P>
	<P><FONT FACE="Arial">При успешной отправке
	возвращается <B>true</B>, иначе – <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if (!sendMTN(&quot;123456&quot;,
	MTN_BEGIN)) {...</B></FONT></FONT></P>
</OL>
<H1><A NAME="9.Работа с иконками/аватарками|outline"></A>
 9.Работа с иконками/аватарками</FONT></FONT></H1>
<H2><A NAME="9.1.getBuddyIcon|outline"></A> 9.1.getBuddyIcon</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	getBuddyIcon(string uin)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод скачивает иконку
	пользователя с UIN'ом <B>uin</B>. Данный вызов
	имеет смысл в двух случаях – при ручной
	обработке, когда элемент в векторе
	<B>ContactListUins</B> для данного <B>uin</B>'а имеет
	поле <B>have_icon==true</B>, либо когда был вызван
	коллбэк <B>onIconChanged(string uin)</B>. Иконка
	сохраняется в поле <B>icon_data</B> соответствующего
	элемента вектора  <B>ContactListUins</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">Структура <B>SSIUINEntry</B>
	имеет следующие поля для иконок:</FONT></P>
	<DD><P><FONT FACE="Arial"><B>bool have_icon</B> – есть ли
	возможность скачать иконку для данного
	контакта</FONT></P>
	<DD><P><FONT FACE="Arial"><B>uint16_t icon_id</B> – ID иконки</FONT></P>
	<DD><P><FONT FACE="Arial"><B>uint8_t icon_flags</B> – Флаги
	иконки</FONT></P>
	<DD><P><FONT FACE="Arial"><B>uint8_t icon_md5_hash[16]</B> –
	MD5-хэш иконки</FONT></P>
	<DD><P><FONT FACE="Arial"><B>vector&lt;uint8_t&gt; icon_data</B> –
	сама иконка (jpeg, gif, или XML)</FONT></P>
	<DD><P><FONT FACE="Arial">Когда от контакта приходит
	Online-нотификация появляется возможность
	скачать его иконку (при ее наличии),
	заполняются ее ID, флаги и MD5-хэш в нужном
	элементе вектора <B>ContactListUins</B>. Если эти
	параметры  изменились, то возникает
	коллбэк <B>onIconChanged</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">Коллбэк не скачивает
	иконку в <B>icon_data</B>, это делается
	пользователем при желании с помощью
	метода  <B>getBuddyIcon</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">Метод возвращает <B>true</B>
	если иконка скачалась успешно, иначе
	– <B>false</B>.</FONT></P>
	<DD><P><FONT COLOR="#cc6633"><FONT FACE="Courier New"><FONT SIZE=2><B>//
	Processing with callback</B></FONT></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onIconChanged(string uin)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!getBuddyIcon(uin)) {...</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>int
	uin_ind=findCLUIN(uin);</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>myProcessUserAvatar(ContactListUins[uin_ind].icon_data);</B></FONT></FONT></P>
	<DD><P><BR><BR>
	</P>
	<DD><P><FONT COLOR="#cc6633"><FONT FACE="Courier New"><FONT SIZE=2><B>//
	Manual processing</B></FONT></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>for (size_t i=0;
	i&lt;ContactListUins.size(); ++i)</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<DD><P>  <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!ContactListUins[i].have_icon) continue;</B></FONT></FONT></P>
	<DD><P>  <FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!getBuddyIcon(ContactListUins[i].uin)) {...</B></FONT></FONT></P>
	<DD><P>  <FONT FACE="Courier New"><FONT SIZE=2><B>myProcessUserAvatar(ContactListUins[i].icon_data);</B></FONT></FONT></P>
</DL>
<H2><A NAME="9.2.downloadMyIcon|outline"></A> 9.2.downloadMyIcon</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	downloadMyIcon(void)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Если пользователь имеет
	иконки, то их параметры при подключении
	к серверу заносятся в публичный
	<B>vector&lt;SSIUINEntry&gt; ContactListIcons</B>. Данный
	метод пытается скачать иконку пользователя
	в поле <B>icon_data</B> каждого элемента этого
	вектора.</FONT></P>
	<DD><P><FONT FACE="Arial">Метод возвращает <B>true</B>
	если иконки скачалась успешно, иначе
	– <B>false</B>.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!downloadMyIcon()) {...</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>for (size_t i=0;
	i&lt;ContactListIcons.size(); ++i)</B></FONT></FONT></P>
	<DD><P> <FONT FACE="Courier New"><FONT SIZE=2><B>myProcessPersonalAvatar(ContactListIcons[i].icon_data);</B></FONT></FONT></P>
</DL>
<H2><A NAME="9.3.uploadMyIcon|outline"></A> 9.3.uploadMyIcon</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	uploadMyIcon(vector&lt;uint8_t&gt; &amp; icon_data)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод закачивает на
	сервер данные <B>icon_data</B> как иконку
	пользователя и добавляет соответствующие
	данные в вектор <B>ContactListIcons</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">Метод возвращает <B>true</B>
	если иконка закачалась успешно, иначе
	– <B>false</B>.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>vector&lt;uint8_t&gt;
	icon_data;</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>myReadFromFile(&quot;myicon.jpg&quot;,
	icon_data);</B></FONT></FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!uploadMyIcon(icon_data)) {...</B></FONT></FONT></P>
</DL>
<H2><A NAME="9.4.deleteMyIcon|outline"></A> 9.4.deleteMyIcon</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	deleteMyIcon(void)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Метод удаляет все иконки
	пользователя с сервера и очищает вектор
	<B>ContactListIcons</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">Метод возвращает <B>true</B>
	если иконки удалились успешно, иначе
	– <B>false</B>.</FONT></P>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>if (!deleteMyIcon())
	{...</B></FONT></FONT></P>
</DL>
<H1><A NAME="10.Основной цикл|outline"></A> 10.Основной
цикл</FONT></FONT></H1>
<OL START=10>
	<P><FONT FACE="Arial">Основной цикл запускается
	после инициализации объекта, успешного
	соединения и авторизации, и проведения
	нужных действий после подключения.
	Цикл производит получение offline-сообщений,
	обрабатывает входящие пакеты, производит
	их разбор и, в случае надобности, вызывает
	нужные коллбэки с соответствующими
	аргументами.</FONT></P>
</OL>
<H2><A NAME="10.1.mainLoop|outline"></A> 10.1.mainLoop</I></FONT></FONT></H2>
<OL START=10>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool mainLoop(bool &amp;
	break_flag)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод запускает основной
	цикл. Цикл прерывается, когда <B>break_flag</B>
	принимает значение <B>true</B>, либо при
	возникновении ошибки.</FONT></P>
	<P><FONT FACE="Arial">При нормальном завершении
	(посредством <B>break_flag</B>) возвращается 
	<B>true</B>. При возникновении какой-либо
	ошибки тут же возвращается <B>false</B>.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool mybrflag=false;</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.mainLoop(mybrflag)) {...</B></FONT></FONT></P>
</OL>
<H1><A NAME="11.Коллбэки|outline"></A> 11.Коллбэки</FONT></FONT></H1>
<OL START=11>
	<P><FONT FACE="Arial">Во время работы основного
	цикла, при возникновении каких либо
	событий, вызываются требуемые коллбэки
	с соответствующими аргументами.</FONT></P>
</OL>
<H2><A NAME="11.1.onIdle|outline"></A> 11.1.onIdle</I></FONT></FONT></H2>
<OL START=11>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onIdle(void)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Этот коллбэк вызывается
	как можно чаще (100-10 раз в секунду).
	Используется для утилитарных целей, к
	примеру, для отрисовки и обработки
	событий GUI.</FONT></P>
	<P><FONT FACE="Arial">Не рекомендуется вызывать
	сетевые методы класса <B>ICQKid2 </B>в этом
	коллбэке без особого контроля, так как
	эти методы тоже могут вызывать <B>onIdle</B>,
	таким образом порождая бесконечную
	рекурсию.</FONT></P>
</OL>
<H2><A NAME="11.2.onIncomingMTN|outline"></A> 11.2.onIncomingMTN</I></FONT></FONT></H2>
<OL START=11>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onIncomingMTN(string from, uint16_t atype)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Коллбэк вызывается при
	получении уведомления о наборе текста
	типа <B>atype</B> от клиента с UIN'ом <B>from</B>.
	Аргумент <B>atype</B> принимает следующие
	значения:</FONT></P>
	<P><FONT FACE="Arial"><B>MTN_BEGIN</B> – начат набор
	текста</FONT></P>
	<P><FONT FACE="Arial"><B>MTN_TYPED</B> – текст набран</FONT></P>
	<P><FONT FACE="Arial"><B>MTN_FINISH</B> – текст отослан</FONT></P>
</OL>
<H2><A NAME="11.3.onIncomingMsg|outline"></A> 11.3.onIncomingMsg</I></FONT></FONT></H2>
<OL START=11>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onIncomingMsg(ICQKid2Message msg)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Коллбэк вызывается при
	получении входящего сообщения. Класс
	<B>ICQKid2Message</B> описан в секции метода
	<B>sendMessage()</B>.</FONT></P>
</OL>
<H2><A NAME="11.4.onAuthRequest|outline"></A> 11.4.onAuthRequest</I></FONT></FONT></H2>
<OL START=11>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onAuthRequest(string from, string text)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Коллбэк вызывается при
	получении запроса авторизации с
	описанием <B>text</B>, от клиента с UIN'ом
	<B>from</B>.</FONT></P>
</OL>
<H2><A NAME="11.5.onAuthReply|outline"></A> 11.5.onAuthReply</I></FONT></FONT></H2>
<OL START=11>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onAuthReply(string from, string text, uint8_t aflag)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Коллбэк вызывается при
	получении подтверждения или отклонения
	авторизации (согласно значению <B>aflag</B>)
	от клиента с UIN'ом <B>from</B>. Возможные
	значения <B>aflag</B> описаны выше.</FONT></P>
</OL>
<H2><A NAME="11.6.onUserNotify|outline"></A> 11.6.onUserNotify</I></FONT></FONT></H2>
<OL START=11>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onUserNotify(string uin, uint32_t stat1, uint32_t stat2, bool
	invis_flag)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Коллбэк вызывается при
	получении нотификации о том, что клиент
	с UIN'ом <B>uin</B> изменил свой статус.
	Основной статус клиента приходит в
	аргументе <B>stat1</B>, дополнительные
	значения статуса в аргументе <B>stat2</B>,
	если пользователь невидим, то флаг
	<B>invis_flag</B> имеет значение <B>true</B>. Возможные
	значения <B>stat1</B> и <B>stat2 </B>описаны выше.
	Если удается определить IP-адрес клиента,
	адрес заносится в поля элемента
	<B>ContactListUins</B>.</FONT></P>
</OL>
<H2><A NAME="11.7.onContactListChanged|outline"></A> 11.7.onContactListChanged</I></FONT></FONT></H2>
<OL START=11>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onContactListChanged(void)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Коллбэк вызывается при
	изменении контакт-листа сервером (к
	примеру, клиент прислал авторизацию).
	До вызова коллбэка локальный контакт-лист
	синхронизируется с полученными
	изменениями.</FONT></P>
</OL>
<H2><A NAME="11.8.onWasAdded|outline"></A> 11.8.onWasAdded</I></FONT></FONT></H2>
<OL START=11>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onWasAdded(string from)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Коллбэк вызывается, когда
	пользователь с UIN'ом <B>from</B> добавляет
	вас в свой контакт-лист.</FONT></P>
</OL>
<H2><A NAME="11.9.onIconChanged|outline"></A> 11.9.onIconChanged</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onIconChanged(string uin)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Коллбэк вызывается, когда
	появляется возможность скачать иконку
	для пользователя с UIN'ом <B>uin</B> (скачать
	можно с помощью <B>getBuddyIcon</B>).</FONT></P>
</DL>
<H2><A NAME="11.10.onXstatusChanged|outline"></A> 11.10.onXstatusChanged</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onXstatusChanged(string uin, size_t x_status, string x_title, string
	x_descr)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Коллбэк вызывается, когда
	пользователь с UIN'ом <B>uin</B> меняет свой
	xStatus (расширение XtraZ) на <B>x_status </B>(возможные
	типы в <B>icqkid2_constants.h</B>) либо заголовок
	xStatus'а на <B>x_title</B>, либо описание xStatus'а
	на <B>x_descr</B>.</FONT></P>
</DL>
<H2><A NAME="11.11.onRegisterControlPicture|outline"></A> 11.11.onRegisterControlPicture</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onRegisterControlPicture(vector&lt;uint8_t&gt; &amp; pic_data,
	string mime_type, string &amp; pic_str)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">При регистрации нового
	UIN'а с помощью <B>registerNewUIN</B> ICQ-сервер
	может прислать картинку с контрольным
	кодом. В этом случае вызывается данный
	коллбэк, в <B>pic_data</B> содержится картинка,
	в <B>mime_type</B> – MIME-тип изображения, по
	ссылке передается строка <B>pic_str</B> в
	которую нужно сохранить контрольный
	код с картинки.</FONT></P>
</DL>
<H2><A NAME="11.12.onIncomingAutoStatusMsg|outline"></A> 11.12.onIncomingAutoStatusMsg</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onIncomingAutoStatusMsg(ICQKid2Message msg, uint8_t type)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Когда контакт из
	контакт-листа меняет свой статус на
	Away/Busy/NA/DND/FFC, ему автоматически отправляется
	запрос на сообщение для текущего
	статуса, при получении ответа на этот
	запрос вызывается данный коллбэк.</FONT></P>
	<DD><P><FONT FACE="Arial">Класс <B>ICQKid2Message</B> описан
	в секции метода <B>sendMessage()</B>.</FONT></P>
	<DD><P><FONT FACE="Arial">Аргумент <B>type</B> может
	иметь следующие значения:</FONT></P>
	<DD><P><FONT FACE="Arial"><B>MSG_TYPE_AUTOAWAY</B> – получено
	Away-сообщение</FONT></P>
	<DD><P><FONT FACE="Arial"><B>MSG_TYPE_AUTOBUSY</B> – получено
	Busy-сообщение</FONT></P>
	<DD><P><FONT FACE="Arial"><B>MSG_TYPE_AUTONA</B> – получено
	NA-сообщение</FONT></P>
	<DD><P><FONT FACE="Arial"><B>MSG_TYPE_AUTODND</B> – получено
	DND-сообщение</FONT></P>
	<DD><P><FONT FACE="Arial"><B>MSG_TYPE_AUTOFFC</B> – получено
	FFC-сообщение</FONT></P>
	<DD><P><FONT FACE="Arial">Также, полученные сообщения
	сохраняются в полях <B>AutoAwayMessageText</B>,
	<B>AutoBusyMessageText</B> и т.д. в соответствующих
	элементах вектора <B>ContactListUins</B>.</FONT></P>
</DL>
<H2><A NAME="11.13.onSingOff|outline"></A> 11.13.onSingOff</I></FONT></FONT></H2>
<DL>
	<DD><P><FONT FACE="Courier New"><FONT SIZE=2><B>virtual void
	onSingOff(uint16_t err_code, string err_url)</B></FONT></FONT></P>
	<DD><P><FONT FACE="Arial">Перед тем как разорвать
	соединение с клиентом, ICQ-сервер присылает
	код ошибки <B>err_code </B>и URL ее описания
	<B>err_url</B>. В этом случае вызывается данный
	коллбэк.</FONT></P>
	<DD><P><FONT FACE="Arial">В файле <B>icqkid2_constants.h</B>
	определены следующие значения для
	<B>err_code</B>:</FONT></P>
	<DD><P><FONT FACE="Arial"><B>SIGNOFF_OTHER_LOCATION</B> –
	произошло другое подключение с
	использованием данного UIN'а.</FONT></P>
</DL>
<H1><A NAME="12.Методы продвинутого использования|outline"></A>
 12.Методы продвинутого использования</FONT></FONT></H1>
<OL START=12>
	<P><FONT FACE="Arial">Здесь описаны методы,
	применяемые для тюнинга сетевых операций
	и для самостоятельной реализации цикла
	обработки событий.</FONT></P>
</OL>
<H2><A NAME="12.1.getConnectPercentage|outline"></A> 12.1.getConnectPercentage</I></FONT></FONT></H2>
<OL START=12>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>int
	getConnectPercentage(void)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">В процессе выполнения
	<B>doConnect</B> можно получать прогресс
	соединения с помощью данного метода.</FONT></P>
	<P><FONT FACE="Arial">Метод возвращает процентаж
	соединения от 1 до 100.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onIdle(void)</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>if (now_conect)</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>cout &lt;&lt;
	&quot;\rConnect percentage &quot; &lt;&lt; getConnectPercentage() &lt;&lt;
	&quot;%   &quot; &lt;&lt; flush;</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>}</B></FONT></FONT></P>
</OL>
<H2><A NAME="12.2.setNetworkTimeout|outline"></A> 12.2.setNetworkTimeout</I></FONT></FONT></H2>
<OL START=12>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	setNetworkTimeout(int tm)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод устанавливает таймаут
	для всех сетевых операций в <B>tm</B>
	миллисекунд. Отрицательное значение
	<B>tm</B> означает бесконечное ожидание.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.setNetworkTimeout(20000);</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.searchByMail(email, search_vec)) {...</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>miif.setNetworkTimeout(-1);</B></FONT></FONT></P>
</OL>
<H2><A NAME="12.3.getNetworkTimeout|outline"></A> 12.3.getNetworkTimeout</I></FONT></FONT></H2>
<OL START=12>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>int
	getNetworkTimeout(void)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод возвращает установленный
	на данный момент сетевой таймаут в
	миллисекундах.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>cout &lt;&lt; &quot;Current
	timeout=&quot; &lt;&lt; miif.getNetworkTimeout() &lt;&lt; endl;</B></FONT></FONT></P>
</OL>
<H2><A NAME="12.4.breakNetworkOperation|outline"></A> 12.4.breakNetworkOperation</I></FONT></FONT></H2>
<OL START=12>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	breakNetworkOperation(void)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод прерывает любую
	выполняющуюся сетевую операцию.</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>void
	MyIcqInterface::onIdle(void)</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>if (need_net_break) </B></FONT></FONT>
	</P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>need_net_break=false;</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>breakNetworkOperation();</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>}</B></FONT></FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>}</B></FONT></FONT></P>
</OL>
<H2><A NAME="12.5.getOfflineMessages|outline"></A> 12.5.getOfflineMessages</I></FONT></FONT></H2>
<OL START=12>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>bool
	getOfflineMessages(void)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод принимает
	offline-сообщения с сервера. Для каждого
	принятого сообщения вызывается коллбэк
	<B>onIncomingMsg</B>. Если вы используете
	стандартный цикл <B>mainLoop</B>, не требуется
	вызывать этот метод явно. Вызывайте
	этот метод только при самостоятельной
	реализации цикла обработки сообщений.</FONT></P>
</OL>
<H2><A NAME="12.6.pollIncomingEvents|outline"></A> 12.6.pollIncomingEvents</I></FONT></FONT></H2>
<OL START=12>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>int
	pollIncomingEvents(int tmout)</B></FONT></FONT></P>
	<P><FONT FACE="Arial">Метод пытается принять
	пакеты из сети в течении <B>tmout</B>
	миллисекунд. Если пакет был принят,
	производится его разбор и вызываются
	нужные коллбэки. Если вы используете
	стандартный цикл <B>mainLoop</B>, не требуется
	вызывать этот метод явно. Вызывайте
	этот метод только при самостоятельной
	реализации цикла обработки сообщений.</FONT></P>
	<P><FONT FACE="Arial">Метод возвращает следующие
	значения:</FONT></P>
	<P><FONT FACE="Arial"><B>1</B> – пакет был принят и
	обработан</FONT></P>
	<P><FONT FACE="Arial"><B>TNETWORK_CLOSE</B> – сервер закрыл
	соединение</FONT></P>
	<P><FONT FACE="Arial"><B>TNETWORK_ERR</B> – ошибка сети</FONT></P>
	<P><FONT FACE="Arial"><B>TNETWORK_TIMEOUT</B> – за время
	<B>tmout</B> не было принято ни одного пакета</FONT></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>if
	(!miif.getOfflineMessages())</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>cerr &lt;&lt; &quot;Cannot
	get offline messages!&quot; &lt;&lt; endl;</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>miif.doDisconnect();</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>return 1;</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>}</B></FONT></FONT></P>
	<P></P>
	<P><FONT FACE="Courier New"><FONT SIZE=2><B>while(!my_break_flag)</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>int
	net_ret=miif.pollIncomingEvents(100);</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>if (net_ret!=1 &amp;&amp;
	net_ret!=TNETWORK_TIMEOUT)</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>{</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>cerr &lt;&lt; &quot;Cannot
	poll incoming events!&quot; &lt;&lt; endl;</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>miif.doDisconnect();</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>return 1;</B></FONT></FONT></P>
	<P>  <FONT FACE="Courier New"><FONT SIZE=2><B>}</B></FONT></FONT></P>
	<P> <FONT FACE="Courier New"><FONT SIZE=2><B>}</B></FONT></FONT></P>
	<P></P>
</OL>
</BODY>
</HTML>